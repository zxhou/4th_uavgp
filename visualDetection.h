
#pragma once

#ifndef uint8
#define uint8  unsigned char
#endif
#ifndef s16
#define s16 short
#endif
#ifndef BYTE
#define BYTE unsigned char
#endif

#pragma pack(push)
#pragma pack(1)

typedef struct tagDigit_POINT
{
	uint8 DisplayWndOrPaintWnd;  //1->dispaly window  0->painting window
	uint8 ImgStatue; // 0-100 CONFIDENCE             ??????㊣?℅???  0????????㊣?????  1??㊣????? 2 ??㊣?????????
	uint8 DigitName; // ??℅???  0,1,2,3,4,5,6,7,8,9
	s16 xPiont_mm;   // w.r.p   center  // ??℅???????????x℅?㊣那?? ????mm  ??????
	s16 yPiont_mm;   // ??℅???????????y℅?㊣那?? ????mm
}Digit_POINT;

typedef struct tagDigit_INFO
{
	uint8 Head;    //   24
	uint8 FrameID; //??ID????﹞????????芍????
	uint8 Key;     //?????邦℅? ?????“??????   	1
	uint8 Spray_Statue; //??????????㊣?℅??? 0????㊣???㊣? 1????㊣?????   VERY
	uint8 SprayScale;   //?㊣?∼????㊣????車??  0-100%   
	uint8 ShotPoint_Statue; // ?足???谷℅?????㊣?℅??? 0????㊣???㊣? 1????㊣?????  x
	s16 ShotPoint_x_mm;  // ?足???谷℅??? ℅?㊣那X  x
	s16 ShotPoint_y_mm;	 // ?足???谷℅??? ℅?㊣那Y  x
	uint8 valid_Digit_N; //   
	Digit_POINT tagDigit_POINT[11]; //tagDigit_POIN[0]????㊣?????℅???tagDigit_POIN[1]- tagDigit_POIN[10]????????10????????11????℅???℅?㊣那????  11*6=66bytes
	uint8 tmp1; // ?∟??
	uint8 tmp2; // ?∟??
}Digit_INFO;  // ???? 78bytes

typedef struct tagUav2Img_INFO
{
	uint8 Head; //	0x24
	uint8 Key; //?????邦℅? ?????“?????? 	2
	uint8 DigitName; //????????????℅?ID??
	s16 DisImg_mm;  // ?角?迆????℅???????
	s16 AngleImg_mrad;	// ?角?迆???????????? ???? ?????? 
	s16 TargSprayPoint_x_mm;  // ??????????㊣?????㊣?℅?㊣那X
	s16 TargSprayPoint_y_mm;  // ??????????㊣?????㊣?℅?㊣那Y
	uint8 Spraygun_status;   //0,3-close 1-ready 2-running 3-finish
	uint8 tmp1; // checksum
	uint8 tmp2; // 0x0d
}Uav2Img_INFO;  // 

#pragma pack(pop)

#ifdef __cplusplus
extern "C"{
#endif

	bool VisualDetection_Initialization(int width, int height);
	void VisualDetection_DoNext(unsigned char *pOrgImg, Uav2Img_INFO *input, Digit_INFO *output, unsigned char *pResImg);

#ifdef __cplusplus
}
#endif
